<div class="p-5 border border-gray-200 rounded-2xl dark:border-gray-800 lg:p-6" *ngIf="registrationDetails">
  <div class="flex flex-col gap-6 lg:flex-row lg:items-start lg:justify-between">
    <div class="flex-1">
      <div class="flex items-center justify-between mb-6">
        <h4 class="text-lg font-semibold text-gray-800 dark:text-white/90">
          Student Details
        </h4>
        <app-button 
          *ngIf="isAdmin"
          size="sm" 
          variant="outline" 
          (btnClick)="openStudentEditModal()"
          className="flex items-center gap-2">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
          Edit
        </app-button>
      </div>
      <div class="grid grid-cols-1 gap-4 lg:grid-cols-4 lg:gap-7 2xl:gap-x-32">
        <div>
          <p class="mb-2 text-xs leading-normal text-gray-500 dark:text-gray-400">
             Name
          </p>
          <p class="text-sm font-medium text-gray-800 dark:text-white/90">
            {{ registrationDetails?.registration?.student.name   }} 
          </p>
        </div>
        <div>
          <p class="mb-2 text-xs leading-normal text-gray-500 dark:text-gray-400">
             Surname
          </p>
          <p class="text-sm font-medium text-gray-800 dark:text-white/90">
            {{ registrationDetails?.registration?.student.surname   }} 
          </p>
        </div>
        <div>
          <p class="mb-2 text-xs leading-normal text-gray-500 dark:text-gray-400">
           ID Number / Passport
          </p>
          <p class="text-sm font-medium text-gray-800 dark:text-white/90">
            {{ registrationDetails?.registration?.student.idNumber || '-'   }} 
          </p>
        </div>

        <div>
          <p class="mb-2 text-xs leading-normal text-gray-500 dark:text-gray-400">
            eMail
          </p>
          <p class="text-sm font-medium text-gray-800 dark:text-white/90">
           {{ registrationDetails?.registration?.student.emailAddress  || '' }} 
          </p>
        </div>
        <div>
          <p class="mb-2 text-xs leading-normal text-gray-500 dark:text-gray-400">
          Cell Phone
          </p>
          <p class="text-sm font-medium text-gray-800 dark:text-white/90">
            {{ registrationDetails?.registration?.student.cellPhone || '' }} 
          </p>
        </div>
      </div>
    </div>
  </div>

  <!-- ID Document Image -->
  <div *ngIf="idDocument" class="mt-6">
    <h4 class="text-lg font-semibold text-gray-800 dark:text-white/90 mb-4">
      Identification Document
    </h4>
    <div class="flex justify-center">
      <img 
        [src]="idDocument" 
        alt="Identification Document"
        class="max-w-full h-auto rounded-lg border border-gray-300 dark:border-gray-700 shadow-sm"
        style="max-height: 500px;"
        (error)="idDocument = null; $event.target.style.display='none'"
      />
    </div>
  </div>

</div>

<!-- Student Details Edit Modal -->
<app-modal [isOpen]="isStudentEditModalOpen" (close)="closeStudentEditModal()" className="relative w-full m-5 sm:m-0 max-w-4xl rounded-3xl bg-white p-6 lg:p-10 dark:bg-gray-900">
  <div>
    <h3 class="text-xl font-semibold text-gray-800 dark:text-white/90 mb-6">
      Edit Student Details
    </h3>
    
    <div class="grid grid-cols-1 gap-6 sm:grid-cols-2">
      <!-- First Name -->
      <div>
        <app-label>First Name</app-label>
        <app-input-field
          type="text"
          placeholder="First Name"
          [value]="studentEditForm.name"
          (valueChange)="studentEditForm.name = $event.toString()"
        />
      </div>

      <!-- Last Name -->
      <div>
        <app-label>Last Name</app-label>
        <app-input-field
          type="text"
          placeholder="Last Name"
          [value]="studentEditForm.surname"
          (valueChange)="studentEditForm.surname = $event.toString()"
        />
      </div>

      <!-- Identification Type -->
      <div>
        <app-label>Identification Type</app-label>
        <app-select
          [options]="idTypeOptions"
          [value]="studentEditForm.idType"
          (valueChange)="studentEditForm.idType = $event"
          placeholder="Select ID type"
        />
      </div>

      <!-- ID Number -->
      <div *ngIf="studentEditForm.idType === 'idNumber'">
        <app-label>ID Number</app-label>
        <app-input-field
          type="text"
          placeholder="ID Number"
          [value]="studentEditForm.idNumber"
          (valueChange)="studentEditForm.idNumber = $event.toString()"
        />
      </div>

      <!-- Passport -->
      <div *ngIf="studentEditForm.idType === 'passport'">
        <app-label>Passport</app-label>
        <app-input-field
          type="text"
          placeholder="Passport"
          [value]="studentEditForm.passport"
          (valueChange)="studentEditForm.passport = $event.toString()"
        />
      </div>

      <!-- Email -->
      <div>
        <app-label>Email Address</app-label>
        <app-input-field
          type="email"
          placeholder="email@example.com"
          [value]="studentEditForm.emailAddress"
          (valueChange)="studentEditForm.emailAddress = $event.toString()"
        />
      </div>

      <!-- Cell Phone -->
      <div>
        <app-label>Cell Phone</app-label>
        <app-input-field
          type="text"
          placeholder="+123 456 7890"
          [value]="studentEditForm.cellPhone"
          (valueChange)="studentEditForm.cellPhone = $event.toString()"
        />
      </div>

      <!-- Street Address -->
      <div>
        <app-label>Street Address</app-label>
        <app-input-field
          type="text"
          placeholder="Street Address"
          [value]="studentEditForm.streetAddress"
          (valueChange)="studentEditForm.streetAddress = $event.toString()"
        />
      </div>

      <!-- City -->
      <div>
        <app-label>City</app-label>
        <app-input-field
          type="text"
          placeholder="City"
          [value]="studentEditForm.city"
          (valueChange)="studentEditForm.city = $event.toString()"
        />
      </div>

      <!-- Address Line 1 -->
      <div>
        <app-label>Address Line 1</app-label>
        <app-input-field
          type="text"
          placeholder="Address Line 1"
          [value]="studentEditForm.line1"
          (valueChange)="studentEditForm.line1 = $event.toString()"
        />
      </div>

      <!-- Address Line 2 -->
      <div>
        <app-label>Address Line 2</app-label>
        <app-input-field
          type="text"
          placeholder="Address Line 2"
          [value]="studentEditForm.line2"
          (valueChange)="studentEditForm.line2 = $event.toString()"
        />
      </div>

      <!-- Postal Code -->
      <div>
        <app-label>Postal Code</app-label>
        <app-input-field
          type="text"
          placeholder="Postal Code"
          [value]="studentEditForm.postalCode"
          (valueChange)="studentEditForm.postalCode = $event.toString()"
        />
      </div>
    </div>

    <!-- Modal Actions -->
    <div class="flex items-center justify-end gap-3 mt-8">
      <app-button
        size="md"
        variant="outline"
        [disabled]="isSavingStudent"
        (btnClick)="closeStudentEditModal()"
      >
        Cancel
      </app-button>
      <app-button
        size="md"
        variant="primary"
        [disabled]="isSavingStudent"
        (btnClick)="saveStudentChanges()"
      >
        @if (isSavingStudent) {
          <span>Saving...</span>
        } @else {
          <span>Save Changes</span>
        }
      </app-button>
    </div>
  </div>
</app-modal>