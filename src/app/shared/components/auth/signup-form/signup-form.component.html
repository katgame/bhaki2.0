<div class="w-full max-w-md mx-auto mb-5 sm:pt-10">
  <a routerLink="/"
    class="inline-flex items-center text-sm text-gray-500 transition-colors hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300">
    <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 20 20" fill="none" class="size-5">
      <path d="M12.7083 5L7.5 10.2083L12.7083 15.4167" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"
        stroke-linejoin="round"></path>
    </svg>
    Back to dashboard
  </a>
</div>

<div class="flex flex-col justify-center flex-1 w-full max-w-md mx-auto">
  <div>
    <div class="mb-5 sm:mb-8">
      <h1 class="mb-2 font-semibold text-gray-800 text-title-sm dark:text-white/90 sm:text-title-md">
        Sign Up
      </h1>
      <p class="text-sm text-gray-500 dark:text-gray-400">
        Enter your email or phone number and password to sign up!
      </p>
    </div>



    <form (ngSubmit)="onSignUp()" #signupForm="ngForm" novalidate>
      <div class="space-y-5">
        <!-- First and Last Name -->
        <div class="grid grid-cols-1 gap-5 sm:grid-cols-2">
          <!-- First Name -->
          <div class="sm:col-span-1">
            <app-label>First Name<span class="text-error-500">*</span></app-label>
            <input type="text" name="fname" [(ngModel)]="fname" #fnameCtrl="ngModel" required
              placeholder="Enter your first name" class="w-full px-3 py-2 border rounded-md" />
            <p *ngIf="fnameCtrl.invalid && fnameCtrl.touched" class="text-sm text-error-500 mt-1">
              First name is required.
            </p>
          </div>

          <!-- Last Name -->
          <div class="sm:col-span-1">
            <app-label>Last Name<span class="text-error-500">*</span></app-label>
            <input type="text" name="lname" [(ngModel)]="lname" #lnameCtrl="ngModel" required
              placeholder="Enter your last name" class="w-full px-3 py-2 border rounded-md" />
            <p *ngIf="lnameCtrl.invalid && lnameCtrl.touched" class="text-sm text-error-500 mt-1">
              Last name is required.
            </p>
          </div>
        </div>

        <!-- Auth Method Toggle -->
        <div>
          <app-label>Sign up with <span class="text-error-500">*</span></app-label>
          <div class="flex gap-4 mb-3">
            <label class="flex items-center gap-2 cursor-pointer">
              <input type="radio" name="authMethod" [(ngModel)]="authMethod" value="email" 
                class="w-4 h-4 text-brand-500 border-gray-300 focus:ring-brand-500" />
              <span class="text-sm text-gray-700 dark:text-gray-300">Email</span>
            </label>
            <label class="flex items-center gap-2 cursor-pointer">
              <input type="radio" name="authMethod" [(ngModel)]="authMethod" value="phone"
                class="w-4 h-4 text-brand-500 border-gray-300 focus:ring-brand-500" />
              <span class="text-sm text-gray-700 dark:text-gray-300">Phone Number</span>
            </label>
          </div>
        </div>

        <!-- Email Field (shown when email is selected) -->
        <div *ngIf="authMethod === 'email'">
          <app-label>Email <span class="text-error-500">*</span></app-label>
          <input type="email" name="email" [(ngModel)]="email" #emailCtrl="ngModel" 
            required
            [pattern]="'^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,}$'"
            placeholder="Enter your email" class="w-full px-3 py-2 border rounded-md" />
          <p *ngIf="emailCtrl.errors?.['required'] && emailCtrl.touched" class="text-sm text-error-500 mt-1">
            Email is required.
          </p>
          <p *ngIf="emailCtrl.errors?.['email'] && emailCtrl.touched" class="text-sm text-error-500 mt-1">
            Please enter a valid email address.
          </p>
          <p *ngIf="emailCtrl.errors?.['pattern'] && emailCtrl.touched && !emailCtrl.errors?.['email']" class="text-sm text-error-500 mt-1">
            Please enter a valid email address.
          </p>
        </div>

        <!-- Phone Number Field (shown when phone is selected) -->
        <div *ngIf="authMethod === 'phone'">
          <app-label>Phone Number <span class="text-error-500">*</span></app-label>
          <input type="tel" name="phoneNumber" [(ngModel)]="phoneNumber" #phoneCtrl="ngModel" 
            required
            placeholder="Enter your phone number (e.g., 0823456789)" class="w-full px-3 py-2 border rounded-md" />
          <p *ngIf="phoneCtrl.errors?.['required'] && phoneCtrl.touched" class="text-sm text-error-500 mt-1">
            Phone number is required.
          </p>
        </div>

        <!-- Password -->
        <div>
          <app-label>Password <span class="text-error-500">*</span></app-label>
          <div class="relative">
            <input [type]="showPassword ? 'text' : 'password'" name="password" [(ngModel)]="password"
              #passwordCtrl="ngModel" required minlength="6" placeholder="Enter your password"
              class="w-full px-3 py-2 border rounded-md" />
            <span (click)="togglePasswordVisibility()"
              class="absolute z-30 -translate-y-1/2 cursor-pointer right-4 top-1/2">
              @if (showPassword) {
              <!-- Eye open -->
              <svg xmlns="http://www.w3.org/2000/svg" class="size-5 fill-gray-500" viewBox="0 0 20 20">
                <path
                  d="M10 3C5 3 1.73 7.11 1 10c.73 2.89 4 7 9 7s8.27-4.11 9-7c-.73-2.89-4-7-9-7zM10 15c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5z" />
              </svg>
              } @else {
              <!-- Eye closed -->
              <svg xmlns="http://www.w3.org/2000/svg" class="size-5 fill-gray-500" viewBox="0 0 20 20">
                <path d="M4.707 3.293a1 1 0 00-1.414 1.414l12 12a1 1 0 001.414-1.414L4.707 3.293z" />
              </svg>
              }
            </span>
          </div>
          <p *ngIf="passwordCtrl.errors?.['required'] && passwordCtrl.touched" class="text-sm text-error-500 mt-1">
            Password is required.
          </p>
          <p *ngIf="passwordCtrl.errors?.['minlength'] && passwordCtrl.touched" class="text-sm text-error-500 mt-1">
            Password must be at least 6 characters long.
          </p>
        </div>

        <!-- Confirm Password -->
        <div>
          <app-label>Confirm Password <span class="text-error-500">*</span></app-label>
          <input [type]="showPassword ? 'text' : 'password'" name="confirmPassword" [(ngModel)]="confirmPassword"
            #confirmPasswordCtrl="ngModel" required placeholder="Confirm your password"
            class="w-full px-3 py-2 border rounded-md" />
          <p *ngIf="confirmPasswordCtrl.invalid && confirmPasswordCtrl.touched" class="text-sm text-error-500 mt-1">
            Confirm password is required.
          </p>
          <p *ngIf="password && confirmPassword && !passwordsMatch" class="text-sm text-error-500 mt-1">
            Passwords do not match.
          </p>
        </div>

        <!-- Terms Checkbox -->
        <div class="flex items-start gap-3">
          <input type="checkbox" name="terms" [(ngModel)]="isChecked" #termsCtrl="ngModel" required
            class="mt-1 w-5 h-5" />
          <p class="text-sm text-gray-600 dark:text-gray-400">
            By creating an account you agree to the
            <span class="text-brand-500">Terms and Conditions</span> and
            <span class="text-brand-500">Privacy Policy</span>.
          </p>
        </div>
        <p *ngIf="termsCtrl.invalid && termsCtrl.touched" class="text-sm text-error-500 mt-1">
          You must agree to the terms.
        </p>

        <!-- Submit Button -->
        <div>
          <button type="submit" [disabled]="!passwordsMatch || !signupForm.valid"
            class="flex items-center justify-center w-full px-4 py-3 text-sm font-medium text-white transition rounded-lg bg-brand-500 shadow-theme-xs hover:bg-brand-600 disabled:opacity-50 disabled:cursor-not-allowed">
            Sign Up
          </button>
        </div>
      </div>
    </form>

    <div class="mt-5">
      <p class="text-sm font-normal text-center text-gray-700 dark:text-gray-400 sm:text-start">
        Already have an account?
        <a routerLink="/signin" class="text-brand-500 hover:text-brand-600 dark:text-brand-400">
          Sign In
        </a>
      </p>
    </div>
  </div>
</div>